# Программа управления печатью стикеров и значков

## Описание

Программа представляет собой графическое приложение для управления процессом печати стикеров, обложек и значков. 
Основные функции:
- Загрузка и обработка заказов из Excel/CSV файлов
- Обновление базы данных артикулов
- Создание файлов для печати
- Управление печатью на нескольких принтерах
- Сбор статистики печати

## Установка

1. Убедитесь, что установлен Python 3.7 или новее
2. Склонируйте репозиторий или скачайте файлы программы
3. Установите зависимости: pip install -r req.txt

Основные классы
1. GroupedRecordsDialog
Диалоговое окно для отображения статистики печати за выбранный период.

Методы:

populate_table() - заполняет таблицу статистикой печати

adjust_dialog_size() - настраивает размер диалогового окна

2. DateRangeDialog
Диалог для выбора диапазона дат для статистики.

Методы:

on_calendar_clicked() - обработка выбора даты

update_date_highlight() - подсветка выбранного диапазона

on_ok_button_clicked() - подтверждение выбора

3. QueueDialog
Основное окно для работы с очередью печати.

Методы:

evt_btn_print_clicked() - создание файлов для выбранных строк заказа

evt_btn_print_all_clicked() - создание файлов для всех строк заказа

get_selected_data(), get_all_data() - получение данных из таблицы

update_progress() - обновление прогресс-бара

4. MainWindow
Главное окно приложения, наследуемое от сгенерированного Ui_MainWindow.

Основные методы:

addPrinterCheckbox() - добавление принтеров в интерфейс

evt_btn_open_file_clicked() - загрузка файла заказа

evt_btn_create_files() - создание файлов для печати

evt_btn_update() - обновление базы данных

evt_btn_print_stickers() - печать стикеров

evt_btn_print_skins() - печать обложек

evt_btn_print_images() - печать значков

on_open_dialog_button_clicked() - открытие диалога статистики

Вспомогательные функции
run_script()
Фоновая задача, выполняющая:

Поиск артикулов для замены, если найдены артикула на яндекс диске, происходит удаление и последующее скачивание при следующем обновлении

Обновление базы с сайта

Проверку базы данных, удаление артикулов не подходящих условиям

Обновление путей к стикерам (ШК, этикетки)

Работает в отдельном потоке с периодичностью 50 минут.

Запуск программы
Инициализация базы данных

Создание необходимых директорий

Настройка логгирования

Создание и запуск главного окна приложения

Запуск фоновой задачи обновления (если не на машине ADMIN)

Настройки
Основные настройки хранятся в модуле config.py:
token - токен яндекс диска, куда отправляются отчеты и прочее
machine_name - имя машины
dbname,user,password,host - настройки подключения к базе PostgreSQL для отчетов в PowerBi(не подключена) 
all_badge - основная папка с базой на локальном компе
sticker_path_all - путь к стикерам(Шк)
acrobat_path - путь к Acrobat

BASE_DIR - базовый директорий

Логирование
Логи сохраняются в logs/logs.log с ротацией 20 МБ. Формат записей:
YYYY-MM-DD HH:mm:ss | уровень | файл | строка | сообщение

Особенности работы
Для работы с PDF используется библиотека PyMuPDF (fitz)

Для асинхронных операций - asyncio

Интерфейс оформлен в темном стиле (qdarkstyle)

Поддерживается печать на нескольких принтерах одновременно

Реализован прогресс-бар для длительных операций

Пример использования
Загрузить файл заказа (кнопка "Загрузить файл")

Обновить базу данных (кнопка "Обновить базу")

Создать файлы для печати (кнопка "Создать файлы")

Выбрать принтеры и запустить печать (соответствующие кнопки)